{"architecture":"amd64","config":{"User":"egerie","ExposedPorts":{"80/tcp":{}},"Env":["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin","PHPIZE_DEPS=autoconf \t\tdpkg-dev \t\tfile \t\tg++ \t\tgcc \t\tlibc-dev \t\tmake \t\tpkg-config \t\tre2c","PHP_INI_DIR=/usr/local/etc/php","APACHE_CONFDIR=/etc/apache2","APACHE_ENVVARS=/etc/apache2/envvars","PHP_CFLAGS=-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64","PHP_CPPFLAGS=-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64","PHP_LDFLAGS=-Wl,-O1 -pie","GPG_KEYS=1729F83938DA44E27BA0F4D3DBDB397470D12172 BFDDD28642824F8118EF77909B67A5C12229118F 2C16C765DBE54A088130F1BC4B9B5F600B55F3B4","PHP_VERSION=8.0.29","PHP_URL=https://www.php.net/distributions/php-8.0.29.tar.xz","PHP_ASC_URL=https://www.php.net/distributions/php-8.0.29.tar.xz.asc","PHP_SHA256=14db2fbf26c07d0eb2c9fab25dbde7e27726a3e88452cca671f0896bbb683ca9","EGERIE_DOCKER=1","UNISONLOCALHOSTNAME=egerie"],"Entrypoint":["/entrypoint"],"WorkingDir":"/var/www/html","Labels":{"build_version":"EGERIE Suite v.4.2.0 - Docker image v.2023.06.09 - PHP v.8.0.29","maintainer":"Emeric Commenge - EGERIE \u003cemeric.commenge@egerie.eu\u003e"},"StopSignal":"SIGWINCH","OnBuild":null},"created":"2023-06-09T15:44:22.058777223+02:00","history":[{"created":"2023-05-23T01:20:14.056617575Z","created_by":"/bin/sh -c #(nop) ADD file:88252a7f118b4d6f55dd5baf49dbcaa053c9d6172c652963c1151fa76f625e44 in / "},{"created":"2023-05-23T01:20:14.397263351Z","created_by":"/bin/sh -c #(nop)  CMD [\"bash\"]","empty_layer":true},{"created":"2023-05-23T09:36:20.764357994Z","created_by":"/bin/sh -c set -eux; \t{ \t\techo 'Package: php*'; \t\techo 'Pin: release *'; \t\techo 'Pin-Priority: -1'; \t} \u003e /etc/apt/preferences.d/no-debian-php"},{"created":"2023-05-23T09:36:20.844015207Z","created_by":"/bin/sh -c #(nop)  ENV PHPIZE_DEPS=autoconf \t\tdpkg-dev \t\tfile \t\tg++ \t\tgcc \t\tlibc-dev \t\tmake \t\tpkg-config \t\tre2c","empty_layer":true},{"created":"2023-05-23T09:36:38.347175292Z","created_by":"/bin/sh -c set -eux; \tapt-get update; \tapt-get install -y --no-install-recommends \t\t$PHPIZE_DEPS \t\tca-certificates \t\tcurl \t\txz-utils \t; \trm -rf /var/lib/apt/lists/*"},{"created":"2023-05-23T09:36:39.088154997Z","created_by":"/bin/sh -c #(nop)  ENV PHP_INI_DIR=/usr/local/etc/php","empty_layer":true},{"created":"2023-05-23T09:36:39.575943955Z","created_by":"/bin/sh -c set -eux; \tmkdir -p \"$PHP_INI_DIR/conf.d\"; \t[ ! -d /var/www/html ]; \tmkdir -p /var/www/html; \tchown www-data:www-data /var/www/html; \tchmod 1777 /var/www/html"},{"created":"2023-05-23T09:39:58.484173704Z","created_by":"/bin/sh -c #(nop)  ENV APACHE_CONFDIR=/etc/apache2","empty_layer":true},{"created":"2023-05-23T09:39:58.569440618Z","created_by":"/bin/sh -c #(nop)  ENV APACHE_ENVVARS=/etc/apache2/envvars","empty_layer":true},{"created":"2023-05-23T09:40:08.296447335Z","created_by":"/bin/sh -c set -eux; \tapt-get update; \tapt-get install -y --no-install-recommends apache2; \trm -rf /var/lib/apt/lists/*; \t\tsed -ri 's/^export ([^=]+)=(.*)$/: ${\\1:=\\2}\\nexport \\1/' \"$APACHE_ENVVARS\"; \t\t. \"$APACHE_ENVVARS\"; \tfor dir in \t\t\"$APACHE_LOCK_DIR\" \t\t\"$APACHE_RUN_DIR\" \t\t\"$APACHE_LOG_DIR\" \t; do \t\trm -rvf \"$dir\"; \t\tmkdir -p \"$dir\"; \t\tchown \"$APACHE_RUN_USER:$APACHE_RUN_GROUP\" \"$dir\"; \t\tchmod 1777 \"$dir\"; \tdone; \t\trm -rvf /var/www/html/*; \t\tln -sfT /dev/stderr \"$APACHE_LOG_DIR/error.log\"; \tln -sfT /dev/stdout \"$APACHE_LOG_DIR/access.log\"; \tln -sfT /dev/stdout \"$APACHE_LOG_DIR/other_vhosts_access.log\"; \tchown -R --no-dereference \"$APACHE_RUN_USER:$APACHE_RUN_GROUP\" \"$APACHE_LOG_DIR\""},{"created":"2023-05-23T09:40:08.96239536Z","created_by":"/bin/sh -c a2dismod mpm_event \u0026\u0026 a2enmod mpm_prefork"},{"created":"2023-05-23T09:40:09.477560071Z","created_by":"/bin/sh -c { \t\techo '\u003cFilesMatch \\.php$\u003e'; \t\techo '\\tSetHandler application/x-httpd-php'; \t\techo '\u003c/FilesMatch\u003e'; \t\techo; \t\techo 'DirectoryIndex disabled'; \t\techo 'DirectoryIndex index.php index.html'; \t\techo; \t\techo '\u003cDirectory /var/www/\u003e'; \t\techo '\\tOptions -Indexes'; \t\techo '\\tAllowOverride All'; \t\techo '\u003c/Directory\u003e'; \t} | tee \"$APACHE_CONFDIR/conf-available/docker-php.conf\" \t\u0026\u0026 a2enconf docker-php"},{"created":"2023-05-23T09:40:09.558315189Z","created_by":"/bin/sh -c #(nop)  ENV PHP_CFLAGS=-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64","empty_layer":true},{"created":"2023-05-23T09:40:09.63514896Z","created_by":"/bin/sh -c #(nop)  ENV PHP_CPPFLAGS=-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64","empty_layer":true},{"created":"2023-05-23T09:40:09.715102236Z","created_by":"/bin/sh -c #(nop)  ENV PHP_LDFLAGS=-Wl,-O1 -pie","empty_layer":true},{"created":"2023-05-23T10:32:59.689811506Z","created_by":"/bin/sh -c #(nop)  ENV GPG_KEYS=1729F83938DA44E27BA0F4D3DBDB397470D12172 BFDDD28642824F8118EF77909B67A5C12229118F 2C16C765DBE54A088130F1BC4B9B5F600B55F3B4","empty_layer":true},{"created":"2023-06-09T02:03:49.251513932Z","created_by":"/bin/sh -c #(nop)  ENV PHP_VERSION=8.0.29","empty_layer":true},{"created":"2023-06-09T02:03:49.3345233Z","created_by":"/bin/sh -c #(nop)  ENV PHP_URL=https://www.php.net/distributions/php-8.0.29.tar.xz PHP_ASC_URL=https://www.php.net/distributions/php-8.0.29.tar.xz.asc","empty_layer":true},{"created":"2023-06-09T02:03:49.415050058Z","created_by":"/bin/sh -c #(nop)  ENV PHP_SHA256=14db2fbf26c07d0eb2c9fab25dbde7e27726a3e88452cca671f0896bbb683ca9","empty_layer":true},{"created":"2023-06-09T02:04:00.771485769Z","created_by":"/bin/sh -c set -eux; \t\tsavedAptMark=\"$(apt-mark showmanual)\"; \tapt-get update; \tapt-get install -y --no-install-recommends gnupg; \trm -rf /var/lib/apt/lists/*; \t\tmkdir -p /usr/src; \tcd /usr/src; \t\tcurl -fsSL -o php.tar.xz \"$PHP_URL\"; \t\tif [ -n \"$PHP_SHA256\" ]; then \t\techo \"$PHP_SHA256 *php.tar.xz\" | sha256sum -c -; \tfi; \t\tif [ -n \"$PHP_ASC_URL\" ]; then \t\tcurl -fsSL -o php.tar.xz.asc \"$PHP_ASC_URL\"; \t\texport GNUPGHOME=\"$(mktemp -d)\"; \t\tfor key in $GPG_KEYS; do \t\t\tgpg --batch --keyserver keyserver.ubuntu.com --recv-keys \"$key\"; \t\tdone; \t\tgpg --batch --verify php.tar.xz.asc php.tar.xz; \t\tgpgconf --kill all; \t\trm -rf \"$GNUPGHOME\"; \tfi; \t\tapt-mark auto '.*' \u003e /dev/null; \tapt-mark manual $savedAptMark \u003e /dev/null; \tapt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false"},{"created":"2023-06-09T02:04:00.893934642Z","created_by":"/bin/sh -c #(nop) COPY file:ce57c04b70896f77cc11eb2766417d8a1240fcffe5bba92179ec78c458844110 in /usr/local/bin/ "},{"created":"2023-06-09T02:06:57.073737911Z","created_by":"/bin/sh -c set -eux; \t\tsavedAptMark=\"$(apt-mark showmanual)\"; \tapt-get update; \tapt-get install -y --no-install-recommends \t\tapache2-dev \t\tlibargon2-dev \t\tlibcurl4-openssl-dev \t\tlibonig-dev \t\tlibreadline-dev \t\tlibsodium-dev \t\tlibsqlite3-dev \t\tlibssl-dev \t\tlibxml2-dev \t\tzlib1g-dev \t; \t\texport \t\tCFLAGS=\"$PHP_CFLAGS\" \t\tCPPFLAGS=\"$PHP_CPPFLAGS\" \t\tLDFLAGS=\"$PHP_LDFLAGS\" \t; \tdocker-php-source extract; \tcd /usr/src/php; \tgnuArch=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\"; \tdebMultiarch=\"$(dpkg-architecture --query DEB_BUILD_MULTIARCH)\"; \tif [ ! -d /usr/include/curl ]; then \t\tln -sT \"/usr/include/$debMultiarch/curl\" /usr/local/include/curl; \tfi; \t./configure \t\t--build=\"$gnuArch\" \t\t--with-config-file-path=\"$PHP_INI_DIR\" \t\t--with-config-file-scan-dir=\"$PHP_INI_DIR/conf.d\" \t\t\t\t--enable-option-checking=fatal \t\t\t\t--with-mhash \t\t\t\t--with-pic \t\t\t\t--enable-ftp \t\t--enable-mbstring \t\t--enable-mysqlnd \t\t--with-password-argon2 \t\t--with-sodium=shared \t\t--with-pdo-sqlite=/usr \t\t--with-sqlite3=/usr \t\t\t\t--with-curl \t\t--with-iconv \t\t--with-openssl \t\t--with-readline \t\t--with-zlib \t\t\t\t--disable-phpdbg \t\t\t\t--with-pear \t\t\t\t$(test \"$gnuArch\" = 's390x-linux-gnu' \u0026\u0026 echo '--without-pcre-jit') \t\t--with-libdir=\"lib/$debMultiarch\" \t\t\t\t--disable-cgi \t\t\t\t--with-apxs2 \t; \tmake -j \"$(nproc)\"; \tfind -type f -name '*.a' -delete; \tmake install; \tfind \t\t/usr/local \t\t-type f \t\t-perm '/0111' \t\t-exec sh -euxc ' \t\t\tstrip --strip-all \"$@\" || : \t\t' -- '{}' + \t; \tmake clean; \t\tcp -v php.ini-* \"$PHP_INI_DIR/\"; \t\tcd /; \tdocker-php-source delete; \t\tapt-mark auto '.*' \u003e /dev/null; \t[ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark; \tfind /usr/local -type f -executable -exec ldd '{}' ';' \t\t| awk '/=\u003e/ { print $(NF-1) }' \t\t| sort -u \t\t| xargs -r dpkg-query --search \t\t| cut -d: -f1 \t\t| sort -u \t\t| xargs -r apt-mark manual \t; \tapt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false; \trm -rf /var/lib/apt/lists/*; \t\tpecl update-channels; \trm -rf /tmp/pear ~/.pearrc; \t\tphp --version"},{"created":"2023-06-09T02:06:57.371522634Z","created_by":"/bin/sh -c #(nop) COPY multi:e11221d43af7136e4dbad5a74e659bcfa753214a9e615c3daf357f1633d9d3d1 in /usr/local/bin/ "},{"created":"2023-06-09T02:06:57.931108354Z","created_by":"/bin/sh -c docker-php-ext-enable sodium"},{"created":"2023-06-09T02:06:58.031810158Z","created_by":"/bin/sh -c #(nop)  ENTRYPOINT [\"docker-php-entrypoint\"]","empty_layer":true},{"created":"2023-06-09T02:06:58.111932623Z","created_by":"/bin/sh -c #(nop)  STOPSIGNAL SIGWINCH","empty_layer":true},{"created":"2023-06-09T02:06:58.202888322Z","created_by":"/bin/sh -c #(nop) COPY file:e3123fcb6566efa979f945bfac1c94c854a559d7b82723e42118882a8ac4de66 in /usr/local/bin/ "},{"created":"2023-06-09T02:06:58.286149111Z","created_by":"/bin/sh -c #(nop) WORKDIR /var/www/html","empty_layer":true},{"created":"2023-06-09T02:06:58.367611023Z","created_by":"/bin/sh -c #(nop)  EXPOSE 80","empty_layer":true},{"created":"2023-06-09T02:06:58.446069047Z","created_by":"/bin/sh -c #(nop)  CMD [\"apache2-foreground\"]","empty_layer":true},{"created":"2023-06-09T15:39:10.13360618+02:00","created_by":"ARG BUILD_DATE","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2023-06-09T15:39:10.13360618+02:00","created_by":"ARG SOFTWARE_VERSION","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2023-06-09T15:39:10.13360618+02:00","created_by":"ARG MAINTAINER=Emeric Commenge - EGERIE \u003cemeric.commenge@egerie.eu\u003e","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2023-06-09T15:39:10.13360618+02:00","created_by":"ARG UNISON_VERSION=2.53.0","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2023-06-09T15:39:10.13360618+02:00","created_by":"ARG OCALM_VERSION=4.10.2","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2023-06-09T15:39:10.13360618+02:00","created_by":"ARG DEBIAN_FRONTEND=noninteractive","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2023-06-09T15:39:10.13360618+02:00","created_by":"LABEL build_version=EGERIE Suite v.4.2.0 - Docker image v.2023.06.09 - PHP v.8.0.29","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2023-06-09T15:39:10.13360618+02:00","created_by":"LABEL maintainer=Emeric Commenge - EGERIE \u003cemeric.commenge@egerie.eu\u003e","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2023-06-09T15:39:10.13360618+02:00","created_by":"ENV EGERIE_DOCKER=1","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2023-06-09T15:39:10.13360618+02:00","created_by":"ENV UNISONLOCALHOSTNAME=egerie","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2023-06-09T15:39:10.13360618+02:00","created_by":"ADD https://github.com/mlocati/docker-php-extension-installer/releases/latest/download/install-php-extensions /usr/local/bin/ # buildkit","comment":"buildkit.dockerfile.v0"},{"created":"2023-06-09T15:39:10.172786743+02:00","created_by":"ADD https://github.com/bcpierce00/unison/releases/download/v2.53.0/unison-v2.53.0+ocaml-4.10.2+x86_64.linux.tar.gz /unison/unison.tar.gz # buildkit","comment":"buildkit.dockerfile.v0"},{"created":"2023-06-09T15:39:16.133658994+02:00","created_by":"COPY files/ / # buildkit","comment":"buildkit.dockerfile.v0"},{"created":"2023-06-09T15:44:22.058777223+02:00","created_by":"RUN |6 BUILD_DATE=2023.06.09 SOFTWARE_VERSION=4.2.0 MAINTAINER=Emeric Commenge - EGERIE \u003cemeric.commenge@egerie.eu\u003e UNISON_VERSION=2.53.0 OCALM_VERSION=4.10.2 DEBIAN_FRONTEND=noninteractive /bin/sh -c apt update \u0026\u0026 apt install -y supervisor sudo default-mysql-client unzip zip pandoc openssl libfontconfig1 apt-utils;    useradd -m -u 83000 -U egerie ;    usermod -G users egerie ;    groupmod -g 83000 egerie ;    chmod +x /usr/local/bin/install-php-extensions ;    install-php-extensions mysqli pdo_mysql zip bz2 apcu intl ;    rm -f /usr/local/bin/install-php-extensions     /usr/local/bin/docker-php-ext-configure     /usr/local/bin/docker-php-ext-enable     /usr/local/bin/docker-php-ext-install     /usr/local/bin/docker-php-source ;    mv \"${PHP_INI_DIR}/php.ini-production\" \"${PHP_INI_DIR}/php.ini\" ;    echo \"memory_limit = -1\" \u003e\u003e \"${PHP_INI_DIR}/php.ini\" ;    chown egerie:egerie \"${PHP_INI_DIR}/php.ini\" ;    sed -i -e \"s/www-data/egerie/g\" /etc/apache2/envvars ;    echo \"export OPENSSL_CONF=/dev/null\" \u003e\u003e /etc/apache2/envvars ;    echo \"ServerName localhost\" \u003e\u003e /etc/apache2/apache2.conf ;    echo \"IncludeOptional /config/apache2/*.conf\" \u003e\u003e /etc/apache2/apache2.conf ;    sed -i -e \"s/443/\\$\\{EGERIE_HTTPS_PORT\\}/g\" /etc/apache2/ports.conf ;    sed -i -e \"s/80/\\$\\{EGERIE_HTTP_PORT\\}/g\" /etc/apache2/ports.conf ;    a2enmod rewrite ;    a2enmod headers ;    a2enmod ssl ;    chown -R egerie:egerie /etc/apache2/ ;    chown -R egerie:egerie /var/www/egerie ;    cd /unison ;    tar -xzvf unison.tar.gz ;    rm -f /unison/unison.tar.gz ;    cp -f /unison/bin/unison /usr/local/bin/unison ;    cp -f /unison/bin/unison-fsmonitor /usr/local/bin/unison-fsmonitor ;    cd .. ;    rm -rf /unison ;    curl -o /usr/local/bin/certmaker https://raw.githubusercontent.com/Moukrea/certmaker/main/certmaker ;    chmod +x /usr/local/bin/certmaker ;    mkdir /certs ;    chown -R egerie:egerie /certs ;    curl -o /usr/local/bin/update-ca-certificates https://salsa.debian.org/debian/ca-certificates/-/raw/master/sbin/update-ca-certificates ;    chmod +x /usr/local/bin/update-ca-certificates ;    rm -rf /etc/supervisor ;    mv -f /etc/supervisord /etc/supervisor ;    touch /var/run/supervisord.pid ;    touch /var/log/supervisor ;    chown -R egerie:egerie /var/log/supervisor /etc/supervisor /var/run/supervisord.pid ;    chmod +x /usr/local/bin/systemctl ;    mkdir /config ;    chown -R egerie:egerie /defaults /config /egerie;    chown egerie:egerie /entrypoint ;    chmod +x /entrypoint ;    chmod +x /egerie/* ;    chmod 750 /etc/sudoers.d ;    chmod 440 /etc/sudoers.d/egerie ;    echo \"       Build version: EGERIE Suite v.${SOFTWARE_VERSION} - Docker image v.${BUILD_DATE} - PHP v.${PHP_VERSION}\" \u003e\u003e /egerie/info.txt ;    echo \"       Maintainer: ${MAINTAINER}\" \u003e\u003e /egerie/info.txt # buildkit","comment":"buildkit.dockerfile.v0"},{"created":"2023-06-09T15:44:22.058777223+02:00","created_by":"USER egerie","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2023-06-09T15:44:22.058777223+02:00","created_by":"ENTRYPOINT [\"/entrypoint\"]","comment":"buildkit.dockerfile.v0","empty_layer":true}],"os":"linux","rootfs":{"type":"layers","diff_ids":["sha256:8cbe4b54fa88d8fc0198ea0cc3a5432aea41573e6a0ee26eca8c79f9fbfa40e3","sha256:2656be2aa5fac8a343862df7e21ec539a566703932c43e3c7d1ad118116b5045","sha256:9a6e8fbbcab1a21c0c3e537623067533ab46b3d868e3512f2e6cd072cf328535","sha256:d682838149b05ce191482d9ce83b77402962c3c756643012d4a75eac0671ce99","sha256:91692ec0375d041999e209bd4e61cfa1498373895517477cf4207a14873f7d84","sha256:d54990acf4bf523e54f01d5739e26871ca29756d84ffc0d8ab4a1ea658203c2b","sha256:5e33913e7a80c68ff4db44bdbd1005074c0cfc33a410555bf8f62b34f4f34a44","sha256:91d36e2e46ae6f4a69c3d770b13ced3745b07acce5ebc7890595cc18896e98d0","sha256:7e13cd6b773d699cd75cc0552716901b4d42b32238d0bfbeccd2f0fb6f6c01ab","sha256:3d4293542381c7ae640e1af0454926db830d48215df9513433e7d7ee238eae57","sha256:da205ee6e2082b10ac29ef5ac701bdbea5d95a207503b1d4b923661d277adeb2","sha256:c9fbdc5bddf1cedc2a666e6f19c4f6e28268cc1fcbd0ad9dcebd586d25e57b3b","sha256:4afc86a07e3edcd6404dd6388693d278f0529f65db3d5b4fae287f27c507ceb7","sha256:2603e1442004ad2dd42c031fd62e9ec931320583ee60f0acd69e12be17051f32","sha256:8c6b74172a7c34b771af4fcec9c9c6b0eacafa321dabe6297fc704a84b286839","sha256:3ab22f29af63fdf240ad8f4e7531bc66591ce2de9429345ebea6a2ca08227171","sha256:aec4ae21ccfc45d9a2e2a409775c283fe6f4223105ce8ff9c62ca1be2618f1b5"]}}